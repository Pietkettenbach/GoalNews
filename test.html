<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GoalNewsDE Live Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #121212;
            color: #fff;
            margin: 0;
            padding: 20px;
        }
        h2 {
            color: #1db954;
        }
        .live-matches {
            background: #1e1e1e;
            padding: 20px;
            border-radius: 10px;
            max-width: 700px;
            margin: 20px auto;
        }
        .live-matches p {
            margin: 10px 0;
            padding: 10px;
            background: #2c2c2c;
            border-radius: 5px;
        }
        em {
            color: #ccc;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="live-matches">
        <h2>⚡ Aktueller Bundesliga-Spieltag</h2>
        <div id="matchesList">Lade Live-Daten...</div>
    </div>

    <script>
    async function loadMatches() {
        const matchesList = document.getElementById("matchesList");
        matchesList.innerHTML = "Lade Live-Daten...";

        try {
            // 1️⃣ Aktuellen Spieltag holen
            const resGroup = await fetch("https://api.openligadb.de/getcurrentgroup/bl1/2025");
            const groupData = await resGroup.json();
            const currentMatchday = groupData.GroupOrderID;

            // 2️⃣ Spiele vom aktuellen Spieltag holen
            const resMatches = await fetch(`https://api.openligadb.de/getmatchdata/bl1/2025/${currentMatchday}`);
            const matches = await resMatches.json();

            matchesList.innerHTML = "";
            matches.forEach(match => {
                const home = match.Team1.TeamName;
                const away = match.Team2.TeamName;
                const scoreHome = match.MatchResults[0]?.PointsTeam1 ?? "-";
                const scoreAway = match.MatchResults[0]?.PointsTeam2 ?? "-";
                const date = new Date(match.MatchDateTimeUTC).toLocaleString("de-DE");

                const p = document.createElement("p");
                p.innerHTML = `<strong>${home} ${scoreHome} - ${scoreAway} ${away}</strong> <em>(${date})</em>`;
                matchesList.appendChild(p);
            });

        } catch (err) {
            console.error("Fehler beim Laden der Spiele:", err);
            matchesList.innerHTML = "<p>Fehler beim Laden der Spiele. Bitte später erneut versuchen.</p>";
        }
    }

    // Direkt laden + alle 5 Minuten aktualisieren
    loadMatches();
    setInterval(loadMatches, 5);
    </script>
</body>
</html>
